<link rel="import" href="../components/polymer/polymer.html">
<link rel="import" href="../components/core-ajax/core-ajax.html">

<polymer-element name="nn-annotable" attributes="nid baseapi">
  <template>

    <core-ajax
      id="get_comments"
      url="{{baseapi}}/{{domain}}/{{nid}}/comments"
      handleAs="json"
      on-core-response="{{populateComments}}">
    </core-ajax>

    <core-ajax
      id="new_comment"
      url="{{baseapi}}/{{domain}}/{{nid}}/comments"
      handleAs="json"
      method="post"
      params='{"author":"{{author}}","text":"{{text}}"}'>
    </core-ajax>

    <content></content>

    <section>
      <h3>New Annotation</h3>
    </section>

  </template>
  <script>
    Polymer({
      attached: function() {
        // In Polymer all attributes are properties of "this".
        if (!this.nid) {
          throw 'Attribute missing: nid';
        }
        this.$.get_comments.go();
      },
      ready: function() {
        this.domain = window.location.hostname;
        this.baseapi = this.baseapi || window.location.origin;
      },
      populateComments: function() {
        // not implemented
      }
    });
  </script>
</polymer-element>
